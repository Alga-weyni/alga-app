When any signature integrity check fails (hash mismatch, decrypt error, tamper signal), the system must:
	‚Ä¢	Email legal@alga.et immediately (production only).
	‚Ä¢	Surface a red banner in the /admin/signatures dashboard with actionable details.
	‚Ä¢	Log the incident (immutable) and deduplicate alerts.

‚∏ª

‚úÖ Scope & Requirements (build exactly as stated)
	1.	Alert Triggers
	‚Ä¢	Trigger on any failure from:
	‚Ä¢	Daily cron signature-integrity-check (02:00 Africa/Addis_Ababa).
	‚Ä¢	On-demand verify endpoint for a record.
	‚Ä¢	Failure categories: HASH_MISMATCH, DECRYPT_FAILURE, DB_INTEGRITY_ERROR, UNKNOWN.
	2.	Email Alerts (Production only)
	‚Ä¢	From: no-reply@alga.et
	‚Ä¢	To: legal@alga.et (primary), security@alga.et (cc if exists).
	‚Ä¢	Subject: ALERT: Signature Integrity Failure ‚Äì <signatureId> ‚Äì <CATEGORY>
	‚Ä¢	Body (plain + HTML):
	‚Ä¢	Summary (category, signatureId, action, timestamp EAT).
	‚Ä¢	Minimal subject user info (user_id only; no PII, no decrypted IP/device).
	‚Ä¢	Links:
	‚Ä¢	View record: /admin/signatures?signatureId=<id>
	‚Ä¢	Generate report: Export filter preset for that record
	‚Ä¢	Deduplication: Do not send more than 1 email per signatureId per 24 hours.
	3.	Admin UI Banner (Dashboard)
	‚Ä¢	Location: /admin/signatures top region, admin-only.
	‚Ä¢	Red banner with count of unresolved failures in last 24h, CTA buttons:
	‚Ä¢	View Failed Only (applies filter)
	‚Ä¢	Export Failures (PDF) (instant)
	‚Ä¢	Acknowledge All (marks acknowledged; no deletion)
	‚Ä¢	Per-admin dismissal persists for the session; does not clear unresolved status.
	4.	APIs (Admin-only)
	‚Ä¢	POST /api/admin/signatures/alerts/test ‚Üí generates one synthetic failure for smoke test (non-production only).
	‚Ä¢	GET /api/admin/signatures/alerts ‚Üí list unresolved failures (paginated, last 30 days).
	‚Ä¢	POST /api/admin/signatures/alerts/acknowledge ‚Üí bulk acknowledge by ids (no delete).
	5.	Storage & Logging
	‚Ä¢	Table: integrity_alerts
	‚Ä¢	id (uuid PK), signature_id, category, first_seen_at, last_seen_at,
occurrence_count, resolved (bool default false), acknowledged_by, acknowledged_at.
	‚Ä¢	Immutability: No update to historical consent log rows; alerts live in separate table.
	‚Ä¢	Audit Extension: Log admin actions (view/acknowledge/export) to dashboard_access_logs.
	6.	Rate Limits & Guardrails
	‚Ä¢	Emails: max 20 alert emails/day (global), dedupe per signatureId/24h.
	‚Ä¢	API export of failures: 10 per hour per admin.
	‚Ä¢	Test endpoint disabled in production.
	7.	Operational Rules
	‚Ä¢	Timezone: Africa/Addis_Ababa for all timestamps in emails/exports.
	‚Ä¢	Security: Never include decrypted IP/device in emails or banner; viewable only via existing Decrypt Audit Info modal.
	‚Ä¢	Footer (emails & PDF exports):
‚ÄúCompliant with Proclamation No. 1072/2018 & No. 1205/2020 ‚Äî Alga Technologies PLC ¬© 2025.‚Äù
	8.	Environment & Config
	‚Ä¢	Use existing mailer config; if missing, require:
	‚Ä¢	ALERTS_ENABLED=true (prod only)
	‚Ä¢	ALERTS_EMAIL_TO=legal@alga.et
	‚Ä¢	Honor NODE_ENV to disable outbound alerts in non-prod.
	‚Ä¢	No third-party paid services; use current mail stack.
	9.	Acceptance Criteria
	‚Ä¢	Trigger a synthetic failure (non-prod): banner appears, alert email generated, alert logged, export works, dedupe respected.
	‚Ä¢	Real failure during daily cron: same behavior; banner persists until acknowledged.
	‚Ä¢	Acknowledgement updates alert state; does not delete records.

‚∏ª

üö´ Do Not
	‚Ä¢	Send decrypted IP/device via email or banner.
	‚Ä¢	Allow non-admins to access alert APIs.
	‚Ä¢	Create more than one email per signature/24h.
	‚Ä¢	Modify or delete consent_logs entries.

‚∏ª

üì¶ Deliverables
	‚Ä¢	Alert pipeline (email + UI banner) live and gated to admin role.
	‚Ä¢	New table integrity_alerts with dedupe/ack flow.
	‚Ä¢	Admin APIs (alerts, acknowledge, test).
	‚Ä¢	Updated Admin Guide section: Integrity Alerts & Response Playbook.